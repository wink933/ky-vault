---
title: 关键路径
tags:
  - "#关键路径"
date: 2026-03-01
---
---
## AOE网

### AOE网的定义

在带权有向图中，若**以顶点表示事件，以有向边表示活动，并以边上的权值表示完成该活动所需的开销**（如时间），则称这种图为用边表示活动的网络，简称 AOE 网。   

### AOE网与AOV网的区别

AOE 网和 AOV 网同属有向无环图，但二者在定义上有本质区别：  
- AOE 网的边**带有权值**，代表活动及其持续时间，而顶点表示事件；  
- AOV 网的边**无权值**，仅用于表示顶点（活动）之间的前后关系。

### AOE网的性质

AOE 网具有以下两个基本性质：

1. **只有在某顶点所代表的事件发生后，从该顶点出发的各有向边所代表的活动才能开始**；

2. **只有当进入某顶点的各有向边所代表的活动都已完成时，该顶点所代表的事件才能发生**。

### 其他定义

#### 开始顶点

在 AOE 网中，通常仅有一个入度为 0 的顶点，称为**开始顶点**（源点），表示整个工程的起点；  

#### 结束顶点

同时仅有一个出度为 0 的顶点，称为**结束顶点**（汇点），表示整个工程的终点。

#### 关键路径与关键活动

在 AOE 网中，有些活动可以并行进行。从源点到汇点可能存在多条有向路径，且这些路径的长度（路径上各边权值之和）可能不同。尽管不同路径上的活动所需时间各异，但只有在所有活动都完成后，整个工程才算结束。  
因此，**在所有从源点到汇点的路径中，路径长度最大的那条路径被称为关键路径，而把关键路径上的活动称为关键活动**。

完成整个工程所需的**最短时间等于关键路径的长度**，即该路径上所有活动持续时间之和。

关键活动决定了工程的总工期，若任一关键活动延迟，整个工程的完成时间将随之推迟。因此，只要识别出关键活动，就能确定关键路径，并得出工程的最早完成时间。


## 关键参数

下面给出在寻找关键活动时所用到的几个关键参数的定义。

### 事件 $v_k$ 的最早发生时间 $v_e(k)$

指从源点 $v_1$ 到顶点 $v_k$ 的最长路径长度。该值决定了所有从 $v_k$ 开始的活动能够开工的最早时间。可用以下递推公式计算：

$$v_e(\text{源点})=0$$

$$v_e(k)=\mathrm{Max}{v_e(j)+\mathrm{Weight}(v_j,v_k)}$$

其中，$v_k$ 是 $v_j$ 的任意后继，Weight$(v_j,v_k)$表示有向边$<v_j,v_k>$上的权值。

---
> 
> **注 意**  
> 计算 $v_e()$ 时，可在拓扑排序过程中同步进行：  
> ① 初始时，令 $v_e[1\ldots n]=0$。  
> ② 每当输出一个入度为 0 的顶点 $v_j$，就计算其所有直接后继顶点 $v_k$ 的最早发生时间，若 $v_e[j]+$ Weight$(v_j,v_k)>v_e[k]$，则更新 $v_e[k]=v_e[j]+$ Weight$(v_j,v_k)$。重复此过程，直至输出全部顶点。

### 事件 $v_k$ 的最迟发生时间 $v_l(k)$

指在不推迟整个工程完成时间的前提下，事件 $v_k$ 必须发生的最晚时间，以保证其所有后继事件 $v_j$ 均不晚于各自的最迟发生时间 $v_l(j)$发生。可用以下递推公式计算：

$$v_l(\text{汇点})=v_e(\text{汇点})$$

$$v_l(k)=\mathrm{Min}{v_l(j)-\mathrm{Weight}(v_k,v_j)}$$

其中，$v_k$ 是 $v_j$ 的任意前驱。

> **注 意**  
> 计算 $v_l(k)$ 时，需按逆拓扑顺序进行。可在拓扑排序时**用栈记录顶点顺序**，排序结束后从栈顶到栈底即为逆拓扑序列。  
> ① 初始时，令 $v_l[1\ldots n]=v_e[n]$。  
> ② 依次弹出栈顶顶点 $v_j$，计算其所有直接前驱顶点 $v_k$ 的最迟发生时间，若 $v_l[j]-$ Weight$(v_k,v_j)<v_l[k]$，则更新 $v_l[k]=v_l[j]-$ Weight$(v_k,v_j)$。重复此过程，直至栈空。

### 活动 $a_i$ 的最早开始时间 $e(i)$

指该活动所对应弧的起点事件的最早发生时间。若边$<v_k,v_j>$表示活动 $a_i$，则有

$$e(i)=v_e(k)$$

### 活动 $a_i$ 的最迟开始时间 $l(i)$

指在不延误工程总工期的前提下，活动 $a_i$ 最迟必须开始的时间，等于其终点事件的最迟发生时间与该活动所需时间之差。若边$<v_k,v_j>$表示活动 $a_i$，则有

$$l(i)=v_l(j)-\mathrm{Weight}(v_k,v_j)$$

### 一个活动 $a_i$ 的最迟开始时间 $l(i)$ 与其最早开始时间 $e(i)$ 的差额：

$$d(i)=l(i)-e(i)$$

或称活动 $a_i$ 的时间余量。该值表示在不延长整个工程总工期的前提下，活动 $a_i$ 可以拖延的时间。若一个活动的时间余量为零，则该活动必须如期完成，否则将导致整个工程延期。因此，满足 $l(i)-e(i)=0$【即 $l(i)=e(i)$】的活动称为关键活动。


求关键路径的算法步骤如下：

① 从源点出发，令 $v_e(\text{源点})=0$，按拓扑有序求其余顶点的最早发生时间 $v_e()$。  
② 从汇点出发，令 $v_l(\text{汇点})=v_e(\text{汇点})$，按逆拓扑有序求其余顶点的最迟发生时间 $v_l()$。  
③ 根据各顶点的 $v_e()$ 值，求所有弧的最早开始时间 $e()$。  
④ 根据各顶点的 $v_l()$ 值，求所有弧的最迟开始时间 $l()$。  
⑤ 求 AOE 网中所有活动的时间余量 $d()$，找出所有 $d()=0$ 的活动构成关键路径。

图 6.23 所示为求解关键路径的具体过程，简单说明如下：

① 求 $v_e()$：初始时 $v_e(1)=0$。在拓扑排序输出顶点的过程中，依次求得 $v_e(2)=3,\ v_e(3)=2,$  
$v_e(4)=\max{v_e(2)+2,\ v_e(3)+4}=\max{5,6}=6,\ v_e(5)=6,\ v_e(6)=\max{v_e(5)+1,\ v_e(4)+2,$  
$v_e(3)+3}=\max{7,8,5}=8$。  
若本题为选择题，仅凭上述 $v_e()$ 的计算过程，通常已可推断出关键路径。

② 求 $v_l()$：初始时 $v_l(6)=8$。在逆拓扑排序（通过栈回溯）过程中，依次求得 $v_l(5)=7,\ v_l(4)=6,$  
$v_l(3)=\min{v_l(4)-4,\ v_l(6)-3}=\min{2,5}=2,\ v_l(2)=\min{v_l(5)-3,\ v_l(4)-2}=\min{4,4}=4,$  
$v_l(1)$必然为 0，无须额外计算。  
③ 弧的最早开始时间 $e()$ 等于该弧的起点顶点的 $v_e()$ 值，结果见下表。  
④ 弧的最迟开始时间 $l()$ 等于该弧的终点顶点的 $v_l()$ 值减去该弧的权值，结果见下表。  
⑤ 由 $l(i)-e(i)=0$ 可确定关键活动，最终得到的关键路径为$(v_1,v_3,v_4,v_6)$。

---

对于关键路径，需要注意以下几点：

1）关键路径上的所有活动均为关键活动，它们共同决定了整个工程的工期。因此，加快关键活动的执行速度有可能缩短总工期。但不能任意缩短关键活动的持续时间，一旦过度缩短，原关键路径的长度可能小于其他路径，从而引发关键路径的转移。此时，即使继续压缩该活动，工程总工期已由新的最长路径决定，不再受其影响。

第 6 章 图 237

2）网中的关键路径可能不止一条。当存在多条关键路径时，仅提高其中某一条路径上的关键活动速度，并不能缩短整个工程的工期。只有加快那些同时出现在所有关键路径上的关键活动（公共关键活动），才能达到缩短工期的目的。

各种图算法在采用邻接矩阵或邻接表存储时的时间复杂度如表 6.5 所示。