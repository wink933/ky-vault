---
title: 特殊矩阵
tags:
  - "#特殊矩阵"
date: 2026-02-20
---

---

## 特殊矩阵的压缩存储


**压缩存储**：为多个值相同的元素只分配一个存储空间，对零元素不分配存储空间。

**特殊矩阵**：指具有大量相同元素或零元素，且这些元素分布具有规律性的矩阵。常见的特殊矩阵有对称矩阵、上（下）三角矩阵、对角矩阵等。

**特殊矩阵的压缩存储方法**：通过分析矩阵中相同元素的分布规律，仅存储一份实际数据，其余的可通过下标映射访问，从而将原本冗余的数据压缩到一个共享的空间中，显著节省内存。

### 对称矩阵

#### 定义

若 $n$ 阶矩阵 $A$ 中任意元素 $a_{i,j}$ 均满足且 $a_{i,j}=a_{j,i}\ (1\le i,j\le n)$，则称其为对称矩阵。其元素可分为三部分：上三角区、主对角线和下三角区，如图 3.20 所示。

#### 存储策略

由于上三角区与下三角区完全对称，若仍用二维数组存储，将近一半空间被浪费。为此可将 $n$ 阶对称矩阵 $A$ 压缩存储于一维数组 $B[n(n+1)/2]$ 中，通常仅存放下三角部分（含主对角线）。
>只存主对角线和下三角部分，按行优先原则依次存储。  
>也可以按照列优先存储，不过下面介绍的是行优先的方式，具体情况需要具体分析

![](assets/特殊矩阵/file-20260220172740096.png)


#### 映射方式
>可以实现一个映射函数将矩阵下标与一维数组下标对应起来。


对于元素 $a_{i,j}\ (i\ge j)$，其在数组 $B$ 中的位置由其前方的元素个数决定

第 1 行：1 个元素（$a_{1,1}$）。  
第 2 行：2 个元素（$a_{2,1},a_{2,2}$）。  
……  
第 $i-1$ 行：$i-1$ 个元素（$a_{i-1,1},a_{i-1,2},\cdots,a_{i-1,i-1}$）。  
第 $i$ 行：$j-1$ 个元素（$a_{i,1},a_{i,2},\cdots,a_{i,j-1}$）。

因此，元素 $a_{i,j}$ 在数组 $B$ 中的下标  
$$  
k=1+2+\cdots+(i-1)+j-1=i(i-1)/2+j-1\ (\text{数组下标从 0 开始})  
$$  
元素下标之间的对应关系如下：  
$$  
k=\begin{cases}  
\dfrac{i(i-1)}{2}+j-1, & i\ge j\ (\text{下三角区和主对角线元素})\\[6pt]  
\dfrac{j(j-1)}{2}+i-1, & i<j\ (\text{上三角区元素 } a_{i,j}=a_{j,i})  
\end{cases}  
$$

#### 注意
描述矩阵元素时，行列号通常从1开始；  
而描述数组时通常下标从零开始。

#### 出题方法

- 存储上三角或者下三角
- 行优先或者列优先
- 矩阵元素的下标从0或者从1开始
- 数组下标从0或者从1开始



### 三角矩阵

#### 下三角矩阵



在下三角矩阵［见图 3.22(a)］中，上三角区的所有元素均为同一常量。其存储思想与对称矩阵的类似，但是需要额外存储该常量一次。因此，可以将 $n$ 阶下三角矩阵 $A$ 压缩存储在 $B[n(n+1)/2+1]$ 中。

对于元素 $a_{i,j}\ (i\ge j)$，其在数组 $B$ 中的下标为  
$$  
k=\begin{cases}  
\dfrac{i(i-1)}{2}+j-1, & i\ge j\ (\text{下三角区和主对角线元素})\\[6pt]  
\dfrac{n(n+1)}{2}, & i<j\ (\text{上三角区元素})  
\end{cases}  
$$
##### 压缩存储策略

![](assets/特殊矩阵/file-20260220174906537.png)

#### 上三角矩阵

在上三角矩阵［见图 3.22(b)］中，下三角区所有元素均为同一常量。只需存储主对角线、上三角区上元素及该常量一次，同样将其压缩存储在 $B[n(n+1)/2+1]$ 中。

![](assets/特殊矩阵/file-20260220174926684.png)

对于元素 $a_{i,j}\ (i\le j)$，其在数组 $B$ 中前方的元素个数为

第 1 行：$n$ 个元素  
第 2 行：$n-1$ 个元素  
……  
第 $i-1$ 行：$n-i+2$ 个元素  
第 $i$ 行：$j-i$ 个元素

故元素 $a_{i,j}$ 在数组 $B$ 中的下标  
$$  
k=n+(n-1)+\cdots+(n-i+2)+(j-i+1)-1=(i-1)(2n-i+2)/2+(j-i)  
$$

元素下标之间的对应关系如下：  
$$  
k=\begin{cases}  
\dfrac{(i-1)(2n-i+2)}{2}+(j-i), & i\le j\ (\text{上三角区和主对角线元素})\\[6pt]  
\dfrac{n(n+1)}{2}, & i>j\ (\text{下三角区元素})  
\end{cases}  
$$
##### 压缩存储策略

![](assets/特殊矩阵/file-20260220174959989.png)

以上推导均假设数组下标从 0 开始。若下标指定从 1 开始，则要相应地调整映射关系。


### 三对角矩阵

若 $n$ 阶矩阵 $A$ 中的任意元素 $a_{i,j}$，当 $|i-j|>1$ 时均有 $a_{i,j}=0\ (1\le i,j\le n)$，则称为三对角矩阵，如图 3.24 所示。非零元素仅集中在以主对角线为中心的 3 条对角线的区域。
![](assets/特殊矩阵/file-20260220175931647.png)

可将三对角上的元素按行优先顺序存入一维数组 $B$，且 $a_{1,1}$ 存于 $B[0]$，如图 3.25 所示。
![](assets/特殊矩阵/file-20260220175944144.png)
三对角上的元素 $a_{i,j}\ (1\le i,j\le n,\ |i-j|\le 1)$ 在一维数组 $B$ 中的下标 $k=2i+j-3$。反之，已知元素存于 $B[k]$ 中时，$i=\lfloor (k+1)/3\rfloor+1,\ j=k-2i+3$。例如，当 $k=0$ 时，$i=\lfloor(0+1)/3+1\rfloor=1,\ j=0-2\times1+3=1$，存放的是 $a_{1,1}$；当 $k=2$ 时，$i=\lfloor(2+1)/3+1\rfloor=2,\ j=2-2\times2+3=1$，存放的是 $a_{2,1}$；当 $k=4$ 时，$i=\lfloor(4+1)/3+1\rfloor=2,\ j=4-2\times2+3=3$，存放的是 $a_{2,3}$。


## 稀疏矩阵

### 定义
若矩阵中非零元素的个数 $t$ 相对于总元素个数 $s$ 来说非常少，即 $t\ll s$，则称该矩阵为稀疏矩阵。

### 压缩存储策略1

为避免空间浪费，稀疏矩阵通常仅存储非零元素。然而，由于非零元素的分布通常是无规律的，仅存储其值是不够的，还需记录它们所在的行和列。为此，将每个非零元素及其对应的行列位置组合成一个三元组（行标 $i$，列标 $j$，值 $a_{i,j}$），如图 3.26 所示。这些三元组可以按某种顺序排列成线性表进行存储。稀疏矩阵压缩存储后便失去了随机存取特性。
>采用顺序存储


$$  
M=\begin{bmatrix}  
4 & 0 & 0 & 0\\
0 & 0 & 6 & 0\\
0 & 9 & 0 & 0\\  
0 & 23 & 0 & 0  
\end{bmatrix}  
$$

对应的三元组

|i|j|$a_{i,j}$|
|---|---|---|
|0|0|4|
|1|2|6|
|2|1|9|
|3|1|23|


稀疏矩阵的三元组表可通过多种方式存储，常见的有：数组存储将所有三元组按某种顺序存储在一维数组中，这种方式简单直接，但插入和删除操作的效率较低；十字链表存储（见 6.2 节）通过链表的方式组织三元组，适用于频繁插入和删除的场景。无论采用哪种方式，都需要额外存储稀疏矩阵的行数、列数和非零元素的个数，以便支持后续的各种操作。

### 压缩存储策略2

十字链表法